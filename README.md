# PySpark Product-Category Solution

Ð ÐµÑˆÐµÐ½Ð¸Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð¿Ð¾ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐµ ÑÐ²ÑÐ·ÐµÐ¹ Ð¼ÐµÐ¶Ð´Ñƒ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð°Ð¼Ð¸ Ð¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼Ð¸ Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ PySpark.

## ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ
ÐŸÑ€Ð¾ÐµÐºÑ‚ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÑŽ ÑÐµÑ€Ð²Ð¸ÑÐ° Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ ÑÐ¾ ÑÐ²ÑÐ·ÑÐ¼Ð¸ "Ð¼Ð½Ð¾Ð³Ð¸Ðµ-ÐºÐ¾-Ð¼Ð½Ð¾Ð³Ð¸Ð¼" Ð¼ÐµÐ¶Ð´Ñƒ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð°Ð¼Ð¸ Ð¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼Ð¸. ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ð·Ð°Ð´Ð°Ñ‡Ð° - Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð²ÑÐµ Ð¿Ð°Ñ€Ñ‹ "Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚-ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ" Ð¸ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ñ‹ Ð±ÐµÐ· ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹ Ð² Ð¾Ð´Ð½Ð¾Ð¼ Ð´Ð°Ñ‚Ð°Ñ„Ñ€ÐµÐ¹Ð¼Ðµ.

## Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
```text
pyspark-solution/
â”œâ”€â”€ main.py # ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ð»Ð¾Ð³Ð¸ÐºÐ° ProductCategoryService
â”œâ”€â”€ test_main.py # Unit-Ñ‚ÐµÑÑ‚Ñ‹ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸
â”œâ”€â”€ pyproject.toml # ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð° Ð¸ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
â””â”€â”€ README.md # Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ
```

## Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ
- ProductCategoryService
ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ ÐºÐ»Ð°ÑÑ, Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÑŽÑ‰Ð¸Ð¹ Ð¼ÐµÑ‚Ð¾Ð´Ñ‹ Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð°Ð¼Ð¸ Ð¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼Ð¸:

- get_products_with_categories() - Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ð²ÑÐµ Ð¿Ð°Ñ€Ñ‹ "Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚-ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ" Ð¸ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ñ‹ Ð±ÐµÐ· ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹

- validate_dataframes() - Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ÑÑ‚ÑŒ Ð²Ñ…Ð¾Ð´Ð½Ñ‹Ñ… Ð´Ð°Ñ‚Ð°Ñ„Ñ€ÐµÐ¹Ð¼Ð¾Ð²

- create_example_dataframes() - ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð»Ñ Ð´ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸

## ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð´Ð°Ð½Ð½Ñ‹Ñ…

### ÐŸÑ€Ð¾Ð´ÑƒÐºÑ‚Ñ‹:

- Laptop (Ñ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼Ð¸: Electronics, Computers)

- Smartphone (Ñ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼Ð¸: Electronics, Mobile)

- Epson (Ñ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÐµÐ¹: Printer)

- Video card (Ñ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÐµÐ¹: Electronics)

- War and peace (Ð±ÐµÐ· ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹)

### ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸:

- Electronics

- Computers

- Mobile

- Printer

- Certificate (Ð±ÐµÐ· Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¾Ð²)

## ðŸš€Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ
Ð—Ð°Ð¿ÑƒÑÐº Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð°
```python
from main import ProductCategoryService
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName("ProductCategoryExample").getOrCreate()
service = ProductCategoryService(spark)

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…
products_df, categories_df, links_df = service.create_example_dataframes()

# ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð°
result_df = service.get_products_with_categories(products_df, categories_df, links_df)
result_df.show()
```

### ðŸ“šÐžÐ¶Ð¸Ð´Ð°ÐµÐ¼Ñ‹Ð¹ Ð²Ñ‹Ð²Ð¾Ð´
```text
+---------------+------------+
|   product_name|category_name|
+---------------+------------+
|         Laptop| Electronics|
|         Laptop|   Computers|
|      Smartphone| Electronics|
|      Smartphone|      Mobile|
|          Epson|     Printer|
|     Video card| Electronics|
|   War and peace|        null|
+---------------+------------+
```
## Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
ÐŸÑ€Ð¾ÐµÐºÑ‚ Ð²ÐºÐ»ÑŽÑ‡Ð°ÐµÑ‚ comprehensive unit-Ñ‚ÐµÑÑ‚Ñ‹, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÑŽÑ‰Ð¸Ðµ:

-ÐšÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ÑÑ‚ÑŒ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ð¸ Ð²Ñ…Ð¾Ð´Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…

-ÐÐ°Ð»Ð¸Ñ‡Ð¸Ðµ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¾Ð² Ð±ÐµÐ· ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹

-Ð”ÑƒÐ±Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¾Ð² Ñ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ð¼Ð¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼Ð¸

-ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ Ð¿ÑƒÑÑ‚Ñ‹Ñ… Ð´Ð°Ñ‚Ð°Ñ„Ñ€ÐµÐ¹Ð¼Ð¾Ð² ÑÐ²ÑÐ·ÐµÐ¹

-ÐšÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ÑÑ‚ÑŒ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼Ñ‹Ñ… Ð¿Ð°Ñ€ "Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚-ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"

### Ð—Ð°Ð¿ÑƒÑÐº Ñ‚ÐµÑÑ‚Ð¾Ð²
```bash
  pytest test_main.py -v
```
### Ð—Ð°Ð¿ÑƒÑÐº Ð»Ð¸Ð½Ñ‚ÐµÑ€Ð¾Ð²
```bash
  mypy .
  black . --check
  ruff check
```

## Ð¢ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð´ÐµÑ‚Ð°Ð»Ð¸

### ðŸ“‹ Ð—Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
- Python >= 3.12

- PySpark >= 4.0.1, < 5.0.0

## ?!ÐŸÑ€ÐµÐ´Ð¿Ð¾Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð¸ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ
- Ð’ÑÐµ Ð´Ð°Ñ‚Ð°Ñ„Ñ€ÐµÐ¹Ð¼Ñ‹ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ñ‚ÑŒ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÐºÐ¾Ð»Ð¾Ð½ÐºÐ¸: product_id, product_name, category_id, category_name

- Ð¡Ð²ÑÐ·Ð¸ Ñ…Ñ€Ð°Ð½ÑÑ‚ÑÑ Ð² Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ð¾Ð¼ Ð´Ð°Ñ‚Ð°Ñ„Ñ€ÐµÐ¹Ð¼Ðµ Ñ ÐºÐ¾Ð»Ð¾Ð½ÐºÐ°Ð¼Ð¸ product_id, category_id

- ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð±ÐµÐ· Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¾Ð² Ð½Ðµ Ð²ÐºÐ»ÑŽÑ‡Ð°ÑŽÑ‚ÑÑ Ð² Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ (Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ð°Ñ€Ñ‹ Ð¸ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ñ‹ Ð±ÐµÐ· ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹)

## ðŸ‘¨â€ðŸ’» ÐÐ²Ñ‚Ð¾Ñ€

Ð“ÑƒÐ±ÐµÐ½Ð¸Ð½ ÐœÐ°ÐºÑÐ¸Ð¼

- Email: maksimgubenin@mail.ru
- GitHub: https://github.com/Maksim-Gubenin